<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Jogo das Frações</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background-color: #f0f8ff;
    }
    h1 {
      margin-top: 20px;
    }
    .hidden {
      display: none;
    }
    .pizza {
      width: 200px;
      height: 200px;
      border-radius: 50%;
      margin: 20px auto;
      position: relative;
      border: 4px solid #cc0000;
    }
    .drop-zone {
      margin-top: 20px;
      padding: 20px;
      border: 2px dashed #666;
      min-height: 50px;
      background-color: #fff;
      width: 300px;
      margin: 0 auto 20px;
      transition: background-color 0.3s ease;
    }
    .fraction {
      display: inline-block;
      margin: 30px;
      background-color: #99ccff;
      color: #000;
      font-size: 27px;
      border-radius: 10px;
      cursor: grab;
      padding: 10px;
      transform: scale(1.5);
      transition: transform 0.2s ease, background-color 0.2s ease;
    }
    .fraction:hover {
      transform: scale(1.6);
    }
    .fraction .numerator {
      display: block;
      border-bottom: 1px solid #000;
    }
    .fraction .denominator {
      display: block;
    }
    .correct {
      background-color: #90ee90 !important;
    }
    .wrong {
      background-color: #f08080 !important;
    }
    #score-board {
      margin-top: 10px;
      font-size: 18px;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      margin-top: 20px;
      cursor: pointer;
    }
    .shake {
      animation: shake 0.4s;
    }
    @keyframes shake {
      0% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      50% { transform: translateX(5px); }
      75% { transform: translateX(-5px); }
      100% { transform: translateX(0); }
    }
  </style>
</head>
<body>
  <div id="start-screen">
    <h1>Bem-vindo ao Jogo das Frações!</h1>
    <p>Você verá uma pizza dividida em partes. Seu objetivo é arrastar a fração correta que representa a parte pintada.</p>
    <p>São 20 níveis com dificuldade crescente. Acertos valem <strong>+10 pontos</strong> e erros <strong>-1 ponto</strong>.</p>
    <button onclick="startGame()">Começar</button>
  </div>

  <div id="game-screen" class="hidden">
    <h1>Jogo das Frações</h1>
    <div id="level-info">Nível 1 de 20</div>
    <div id="score-board">Pontuação: 0</div>
    <div id="pizza" class="pizza"></div>
    <div class="drop-zone" id="dropZone">
      Solte aqui a fração correta
    </div>
    <div id="fractions"></div>
    <button onclick="nextLevel()" class="hidden" id="nextButton">Próximo Nível</button>
  </div>

  <audio id="sound-correct">
    <source src="./correct-6033(1).mp3" type="audio/mpeg">
  </audio>
  <audio id="sound-wrong">
    <source src="./wrong-47985.mp3" type="audio/mpeg">
  </audio>

  <script>
    const pizza = document.getElementById("pizza");
    const dropZone = document.getElementById("dropZone");
    const fractionsContainer = document.getElementById("fractions");
    const levelInfo = document.getElementById("level-info");
    const scoreBoard = document.getElementById("score-board");
    const nextButton = document.getElementById("nextButton");

    const soundCorrect = document.getElementById("sound-correct");
    const soundWrong = document.getElementById("sound-wrong");

    const levels = [
      "1/2", "1/3", "1/4", "3/4", "2/3", "3/5", "4/5", "1/5", "1/6", "5/6",
      "1/8", "3/8", "5/8", "7/8", "2/6", "2/4", "3/6", "1/10", "3/10", "9/10"
    ];

    let currentLevel = 0;
    let score = 0;

    function startGame() {
      document.getElementById("start-screen").classList.add("hidden");
      document.getElementById("game-screen").classList.remove("hidden");
      loadLevel();
    }

    function loadLevel() {
      const fraction = levels[currentLevel];
      levelInfo.textContent = `Nível ${currentLevel + 1} de 20`;
      scoreBoard.textContent = `Pontuação: ${score}`;
      nextButton.classList.add("hidden");
      dropZone.textContent = "Solte aqui a fração correta";
      dropZone.classList.remove("correct", "wrong", "shake");
      pizza.style.background = generatePizzaGradient(fraction);
      fractionsContainer.innerHTML = "";

      const options = generateOptions(fraction);
      options.forEach(value => {
        const div = document.createElement("div");
        div.className = "fraction";
        div.setAttribute("draggable", "true");
        div.dataset.value = value;

        const [num, den] = value.split("/");
        div.innerHTML = `<span class='numerator'>${num}</span><span class='denominator'>${den}</span>`;

        div.addEventListener("dragstart", (e) => {
          e.dataTransfer.setData("text/plain", value);
        });
        fractionsContainer.appendChild(div);
      });
    }

    function generatePizzaGradient(fraction) {
      const [num, den] = fraction.split("/").map(Number);
      const percent = (num / den) * 100;
      return `conic-gradient(#ff9999 0% ${percent}%, #ffffff ${percent}% 100%)`;
    }

    function generateOptions(correct) {
      const options = new Set([correct]);
      while (options.size < 5) {
        const n = Math.floor(Math.random() * 9) + 1;
        const d = Math.floor(Math.random() * 10) + 1;
        if (n < d) options.add(`${n}/${d}`);
      }
      return Array.from(options).sort(() => Math.random() - 0.5);
    }

    dropZone.addEventListener("dragover", (e) => e.preventDefault());

    dropZone.addEventListener("drop", (e) => {
      e.preventDefault();
      const value = e.dataTransfer.getData("text/plain");
      const correctValue = levels[currentLevel];

      dropZone.classList.remove("correct", "wrong", "shake");

      if (value === correctValue) {
        dropZone.innerHTML = `Correto! A fração é:<br><span class='fraction correct'><span class='numerator'>${value.split("/")[0]}</span><span class='denominator'>${value.split("/")[1]}</span></span>`;
        dropZone.classList.add("correct");
        soundCorrect.currentTime = 0;
        soundCorrect.play();
        score += 10;
        scoreBoard.textContent = `Pontuação: ${score}`;
        nextButton.classList.remove("hidden");
      } else {
        dropZone.innerHTML = `Incorreto. Tente novamente.`;
        dropZone.classList.add("wrong", "shake");
        soundWrong.currentTime = 0;
        soundWrong.play();
        score -= 1;
        scoreBoard.textContent = `Pontuação: ${score}`;
      }
    });

    function nextLevel() {
      currentLevel++;
      if (currentLevel < levels.length) {
        loadLevel();
      } else {
        alert(`Parabéns! Você completou todos os níveis. Pontuação final: ${score}`);
        location.reload();
      }
    }
  </script>
</body>
</html>
