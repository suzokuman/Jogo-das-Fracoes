<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jogo de Aritmética</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f0f8ff;
      text-align: center;
      padding: 30px;
    }
    h1 {
      margin-bottom: 20px;
    }
    p {
      font-size: 20px;
      margin: 10px 0;
    }
    button {
      padding: 12px 24px;
      font-size: 20px;
      margin-top: 20px;
      cursor: pointer;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 10px;
    }
    #question {
      font-size: 36px;
      margin-bottom: 20px;
    }
    .option {
      display: block;
      margin: 20px auto;
      padding: 15px 30px;
      font-size: 24px;
      width: 300px;
      cursor: pointer;
      background-color: #e0e0e0;
      border: none;
      border-radius: 10px;
      transition: background-color 0.3s ease;
    }
    .option:hover {
      background-color: #ccc;
    }
    .correct {
      background-color: #4CAF50 !important;
      color: white;
    }
    .incorrect {
      background-color: #f44336 !important;
      color: white;
    }
    #score {
      font-size: 20px;
      margin-top: 20px;
    }
    #intro {
      display: none;
    }
  </style>
</head>
<body>
  <div id="intro">
    <h1 id="intro-title"></h1>
    <p>Você verá contas de <span id="intro-type"></span>. Seu objetivo é escolher a resposta correta que representa a conta exibida.</p>
    <p>São 20 níveis com dificuldade crescente.</p>
    <p>Acertos valem +10 pontos e erros -1 ponto.</p>
    <button onclick="iniciarJogo()">Começar</button>
  </div>

  <div id="jogo" style="display: none">
    <h1>Jogo de Aritmética</h1>
    <div id="question"></div>
    <div id="options"></div>
    <div id="score">Pontuação: <span id="score-value">0</span></div>
  </div>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const tipo = urlParams.get("tipo") || "soma";
    let nivel = 1;
    let score = 0;

    const tiposTexto = {
      soma: "Soma",
      subtracao: "Subtração",
      multiplicacao: "Multiplicação",
      divisao: "Divisão"
    };

    document.getElementById("intro-title").textContent = `Bem-vindo ao Jogo da ${tiposTexto[tipo]}`;
    document.getElementById("intro-type").textContent = tiposTexto[tipo];
    document.getElementById("intro").style.display = "block";

    function iniciarJogo() {
      document.getElementById("intro").style.display = "none";
      document.getElementById("jogo").style.display = "block";
      exibirPergunta();
    }

    function gerarNumeroAleatorio() {
      return Math.floor(Math.random() * 900) + 100; // número entre 100 e 999
    }

    function gerarPergunta() {
      let a = gerarNumeroAleatorio();
      let b = gerarNumeroAleatorio();
      let pergunta = "";
      let respostaCorreta = 0;

      switch (tipo) {
        case "soma":
          respostaCorreta = a + b;
          pergunta = `${a} + ${b}`;
          break;
        case "subtracao":
          if (a < b) [a, b] = [b, a];
          respostaCorreta = a - b;
          pergunta = `${a} - ${b}`;
          break;
        case "multiplicacao":
          a = Math.floor(Math.random() * 90) + 10;
          b = Math.floor(Math.random() * 9) + 1;
          respostaCorreta = a * b;
          pergunta = `${a} × ${b}`;
          break;
        case "divisao":
          b = Math.floor(Math.random() * 9) + 1;
          respostaCorreta = Math.floor(Math.random() * 90) + 10;
          a = respostaCorreta * b;
          pergunta = `${a} ÷ ${b}`;
          break;
      }

      return { pergunta, respostaCorreta };
    }

    function gerarOpcoes(respostaCorreta) {
      const opcoes = new Set();
      opcoes.add(respostaCorreta);
      while (opcoes.size < 5) {
        let desvio = Math.floor(Math.random() * 21) - 10;
        let alternativa = respostaCorreta + desvio;
        if (alternativa >= 0) opcoes.add(alternativa);
      }
      return Array.from(opcoes).sort(() => Math.random() - 0.5);
    }

    function exibirPergunta() {
      if (nivel > 20) {
        window.location.href = `fim.html?score=${score}`;
        return;
      }

      const q = gerarPergunta();
      const opcoes = gerarOpcoes(q.respostaCorreta);
      document.getElementById("question").textContent = `Nível ${nivel}: ${q.pergunta}`;
      const container = document.getElementById("options");
      container.innerHTML = "";

      opcoes.forEach(opcao => {
        const btn = document.createElement("button");
        btn.className = "option";
        btn.textContent = opcao;
        btn.onclick = () => verificarResposta(opcao, q.respostaCorreta, btn);
        container.appendChild(btn);
      });
    }

    function verificarResposta(selecionada, correta, botao) {
      const botoes = document.querySelectorAll(".option");
      botoes.forEach(btn => btn.disabled = true);

      if (selecionada === correta) {
        botao.classList.add("correct");
        score += 10;
        document.getElementById("score-value").textContent = score;
        setTimeout(() => {
          nivel++;
          exibirPergunta();
        }, 1000);
      } else {
        botao.classList.add("incorrect");
        score -= 1;
        document.getElementById("score-value").textContent = score;
        setTimeout(() => {
          botoes.forEach(btn => btn.disabled = false);
          botao.classList.remove("incorrect");
        }, 1000);
      }
    }
  </script>
</body>
</html>
